(()=>{"use strict";var e,n={44:(e,n,t)=>{t(790),t(146)},146:(e,n,t)=>{function o(e){const n=e.dimensions.x,t=e.dimensions.y,o=e.dimensions.z;return 2*(n*t+n*o+t*o)}function a(e){return e.dimensions.x*e.dimensions.y*e.dimensions.z}var s=t(387);async function r(e,n){(0,s.QK)("LOADING");try{const t=`file.${(0,s.ti)(e)}`;try{n.FS.unlink(`/${t}`)}catch(e){}const r=await(0,s.xc)(e);console.log(r),n.FS.createDataFile("/",t,r,!0,!0),console.log(`파일 '${t}'을 가상 파일 시스템에 생성했습니다.`);const i=new n.STEPControl_Reader_1;if(console.log("STEPControl_Reader 인스턴스 생성됨"),i.ReadFile(t)!==n.IFSelect_ReturnStatus.IFSelect_RetDone)throw new Error("STEP 파일 읽기 실패");{console.log("STEP 파일 읽기 성공");const e=new n.Message_ProgressRange_1,t=i.TransferRoots(e);console.log(`변환된 루트 수: ${t}`);const r=i.OneShape();if(!r)throw new Error("형상을 가져올 수 없습니다.");{console.log("형상 가져오기 성공");const e=function(e,n){const t=new n.Bnd_Box_1;n.BRepBndLib.Add(e,t,!0);const o=t.CornerMin(),a=t.CornerMax(),s=o.X(),r=o.Y(),i=o.Z(),c=a.X(),l=a.Y(),d=a.Z();return{min:{x:s,y:r,z:i},max:{x:c,y:l,z:d},dimensions:{x:c-s,y:l-r,z:d-i}}}(r,n),t={aabb:e,area:o(e),volume:a(e)};(0,s.QK)("RESULTS",t)}}n.FS.unlink(`/${t}`)}catch(e){console.error("STEP 처리 중 오류 발생:",e),(0,s.QK)("PROCESSING_ERROR",{message:e.message})}}(0,s.PA)().then((e=>{document.getElementById("step-file").addEventListener("change",(async n=>{await r(n.target.files[0],e)}));const n=document.getElementsByClassName("test");for(const t of n)t.addEventListener("click",(async n=>{const t=n.target.name,o=await fetch(t).then((e=>e.blob())),a=new File([o],t,{type:"application/octet-stream"});await r(a,e)}))}))},387:(e,n,t)=>{t.d(n,{PA:()=>a,QK:()=>i,ti:()=>r,xc:()=>s});var o=t(57);const a=async()=>{try{if(void 0===o.A)throw new Error("OpenCascade.js 라이브러리를 찾을 수 없습니다.");const e=await(0,o.A)();return console.log("OpenCascade.js 초기화 완료"),i("LOAD_SUCCESS"),e}catch(e){throw console.error("OpenCascade.js 초기화 오류:",e),i("LIB_ERROR",{message:e.message}),e}},s=e=>new Promise(((n,t)=>{let o=new FileReader;o.onload=()=>n(o.result),o.onerror=t,o.readAsText(e)})),r=e=>{switch(e.name.toLowerCase().split(".").pop()){case"step":case"stp":return"step";case"iges":case"igs":return"iges";default:return}};function i(e,n={}){const t=document.getElementById("result");switch(e){case"LOADING":t.innerHTML='<div class="loading">STEP 파일 분석 중...</div>';break;case"LOAD_SUCCESS":t.innerHTML='<p class="success">OpenCascade.js 로드 완료. STEP 파일을 선택해주세요.</p>';break;case"LIB_ERROR":t.innerHTML=`\n          <div class="error">\n            <h3>라이브러리 로드 오류</h3>\n            <p>${n.message}</p>\n            <p>브라우저 콘솔에서 추가 정보를 확인하세요.</p>\n          </div>\n        `;break;case"INIT_ERROR":t.innerHTML='\n          <div class="error">\n            <h3>라이브러리 오류</h3>\n            <p>OpenCascade.js를 초기화할 수 없습니다. 페이지를 새로고침 후 다시 시도해주세요.</p>\n          </div>\n        ';break;case"PROCESSING_ERROR":t.innerHTML=`\n          <div class="error">\n            <h3>오류 발생</h3>\n            <p>${n.message}</p>\n            <p>브라우저 콘솔에서 추가 정보를 확인하세요.</p>\n          </div>\n        `;break;case"RESULTS":t.innerHTML=`\n          <div class="success">STEP 파일을 성공적으로 처리했습니다!</div>\n          <h3>AABB 계산 결과</h3>\n          <p>치수: ${n.aabb.dimensions.x.toFixed(2)} × ${n.aabb.dimensions.y.toFixed(2)} × ${n.aabb.dimensions.z.toFixed(2)}</p>\n          <p>표면적: ${n.area.toFixed(2)} 제곱 단위</p>\n          <p>부피: ${n.volume.toFixed(2)} 입방 단위</p>\n          <h4>좌표</h4>\n          <p>최소: (${n.aabb.min.x.toFixed(2)}, ${n.aabb.min.y.toFixed(2)}, ${n.aabb.min.z.toFixed(2)})</p>\n          <p>최대: (${n.aabb.max.x.toFixed(2)}, ${n.aabb.max.y.toFixed(2)}, ${n.aabb.max.z.toFixed(2)})</p>\n        `}}},790:(e,n,t)=>{var o=t(387),a=t(514),s=t(525);const r={setOpenCascade(e){this.openCascade=e},tessellate(e){const n=[];new this.openCascade.BRepMesh_IncrementalMesh_2(e,.1,!1,.5,!1);const t=new this.openCascade.TopExp_Explorer_1;for(t.Init(e,this.openCascade.TopAbs_ShapeEnum.TopAbs_FACE,this.openCascade.TopAbs_ShapeEnum.TopAbs_SHAPE);t.More();t.Next()){const e=this.openCascade.TopoDS.Face_1(t.Current()),o=new this.openCascade.TopLoc_Location_1,a=this.openCascade.BRep_Tool.Triangulation(e,o,0);if(a.IsNull())continue;const s={vertex_coord:[],normal_coord:[],tri_indexes:[],number_of_triangles:0},r=new this.openCascade.Poly_Connect_2(a),i=a.get();s.vertex_coord=new Array(3*i.NbNodes());for(let e=1;e<=i.NbNodes();e++){const n=i.Node(e).Transformed(o.Transformation());s.vertex_coord[3*(e-1)+0]=n.X(),s.vertex_coord[3*(e-1)+1]=n.Y(),s.vertex_coord[3*(e-1)+2]=n.Z()}const c=new this.openCascade.TColgp_Array1OfDir_2(1,i.NbNodes());this.openCascade.StdPrs_ToolTriangulatedShape.Normal(e,r,c),s.normal_coord=new Array(3*c.Length());for(let e=c.Lower();e<=c.Upper();e++){const n=c.Value(e).Transformed(o.Transformation());s.normal_coord[3*(e-1)+0]=n.X(),s.normal_coord[3*(e-1)+1]=n.Y(),s.normal_coord[3*(e-1)+2]=n.Z()}const l=e.Orientation_1(),d=a.get().Triangles();s.tri_indexes=new Array(3*d.Length());let p=0;for(let e=1;e<=a.get().NbTriangles();e++){const n=d.Value(e);let t=n.Value(1),o=n.Value(2),a=n.Value(3);if(l!==this.openCascade.TopAbs_Orientation.TopAbs_FORWARD){let e=t;t=o,o=e}s.tri_indexes[3*p+0]=t,s.tri_indexes[3*p+1]=o,s.tri_indexes[3*p+2]=a,p++}s.number_of_triangles=p,n.push(s)}return n},joinPrimitives(e){let n=0,t=0,o=0,a=0;const s=[],r=[],i=[];return e.forEach((e=>{for(let t=0;t<e.vertex_coord.length/3;t++)s[3*n+0]=e.vertex_coord[3*t+0],s[3*n+1]=e.vertex_coord[3*t+1],s[3*n+2]=e.vertex_coord[3*t+2],n++;for(let n=0;n<e.normal_coord.length/3;n++)r[3*t+0]=e.normal_coord[3*n+0],r[3*t+1]=e.normal_coord[3*n+1],r[3*t+2]=e.normal_coord[3*n+2],t++;for(let n=0;n<e.tri_indexes.length/3;n++)i[3*o+0]=e.tri_indexes[3*n+0]+a-1,i[3*o+1]=e.tri_indexes[3*n+1]+a-1,i[3*o+2]=e.tri_indexes[3*n+2]+a-1,o++;a=n})),[s,r,i]},objGetTriangle(e,n){const t=3*n[3*e+0],o=3*n[3*e+1],a=3*n[3*e+2];return[[t,o,a],[t,o,a],[t,o,a]]},generateGeometry(e,n,t,o){const s=[],r=[];function i(e,n,t){s.push(new a.Pq0(e,n,t))}for(let t=0;t<e;t++){const[e,,]=this.objGetTriangle(t,o);i(n[e[0]+0],n[e[0]+1],n[e[0]+2]),i(n[e[1]+0],n[e[1]+1],n[e[1]+2]),i(n[e[2]+0],n[e[2]+1],n[e[2]+2])}for(let n=0;n<e;n++){const[,e]=this.objGetTriangle(n,o);c=0+3*n,l=1+3*n,d=2+3*n,p=t[e[0]+0],m=t[e[0]+1],u=t[e[0]+2],_=t[e[1]+0],h=t[e[1]+1],g=t[e[1]+2],w=t[e[2]+0],f=t[e[2]+1],b=t[e[2]+2],r.push(new a.nFj(c,l,d,[new a.Pq0(p,m,u),new a.Pq0(_,h,g),new a.Pq0(w,f,b)]))}var c,l,d,p,m,u,_,h,g,w,f,b;return[s,r]}},i=async(e,n,t,a)=>{const s=(0,o.ti)(n),r=`file.${s}`;await(0,o.xc)(n).then((async o=>{e.FS.createDataFile("/",r,o,!0,!0);var i=null;if("step"===s?i=new e.STEPControl_Reader_1:"iges"===s?i=new e.IGESControl_Reader_1:console.error("opencascade.js can't parse this extension! (yet)"),i.ReadFile(r)===e.IFSelect_ReturnStatus.IFSelect_RetDone){console.log("file loaded successfully!     Converting to OCC now..."),i.TransferRoots(new e.Message_ProgressRange_1);const o=i.OneShape();console.log(n.name+" converted successfully!  Triangulating now..."),a.remove(a.getObjectByName("shape")),await t(e,o,a),console.log(n.name+" triangulated and added to the scene!"),e.FS.unlink(`/file.${s}`)}else console.error("Something in OCCT went wrong trying to read "+n.name)}))},c=async(e,n,t)=>{r.setOpenCascade(e);const o=await r.tessellate(n),[s,i,c]=await r.joinPrimitives(o),l=o.reduce(((e,n)=>e+n.number_of_triangles),0),[d,p]=await r.generateGeometry(l,s,i,c),m=new a._4j({color:new a.Q1f(.9,.9,.9)}),u=new a.V23;u.vertices=d,u.faces=p;const _=new a.eaF(u,m);_.name="shape",_.rotation.x=-Math.PI/2,t.add(_)},l=(()=>{var e=new a.Z58,n=new a.ubm(75,window.innerWidth/window.innerHeight,.1,1e3),t=new a.JeP({antialias:!0});const o=document.getElementById("viewport"),r=o.getBoundingClientRect();t.setSize(r.width,r.height),o.appendChild(t.domElement);const i=new a.$p8(4210752);e.add(i);const c=new a.ZyN(16777215,.5);c.position.set(.5,.5,.5),e.add(c),n.position.set(0,50,100);const l=new s.N(n,t.domElement);return l.screenSpacePanning=!0,l.target.set(0,50,0),l.update(),function o(){requestAnimationFrame(o),t.render(e,n)}(),e})();(0,o.PA)().then((e=>{document.getElementById("step-file").addEventListener("input",(async n=>{await i(e,n.target.files[0],c,l)}));const n=document.getElementsByClassName("test");for(const t of n)t.addEventListener("click",(async n=>{const t=n.target.name,o=await fetch(t).then((e=>e.blob())),a=new File([o],t,{type:"application/octet-stream"});await i(e,a,c,l)}))}))}},t={};function o(e){var a=t[e];if(void 0!==a)return a.exports;var s=t[e]={exports:{}};return n[e](s,s.exports,o),s.exports}o.m=n,e=[],o.O=(n,t,a,s)=>{if(!t){var r=1/0;for(d=0;d<e.length;d++){for(var[t,a,s]=e[d],i=!0,c=0;c<t.length;c++)(!1&s||r>=s)&&Object.keys(o.O).every((e=>o.O[e](t[c])))?t.splice(c--,1):(i=!1,s<r&&(r=s));if(i){e.splice(d--,1);var l=a();void 0!==l&&(n=l)}}return n}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[t,a,s]},o.d=(e,n)=>{for(var t in n)o.o(n,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),o.p="./",(()=>{var e={631:0,673:0,792:0};o.O.j=n=>0===e[n];var n=(n,t)=>{var a,s,[r,i,c]=t,l=0;if(r.some((n=>0!==e[n]))){for(a in i)o.o(i,a)&&(o.m[a]=i[a]);if(c)var d=c(o)}for(n&&n(t);l<r.length;l++)s=r[l],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(d)},t=self.webpackChunkcad_ocjs=self.webpackChunkcad_ocjs||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var a=o.O(void 0,[462,525],(()=>o(44)));a=o.O(a)})();
//# sourceMappingURL=main.ec549049f72ae5f69184.bundle.js.map