(()=>{"use strict";var e,n={387:(e,n,o)=>{o.d(n,{PA:()=>r,ti:()=>s,xc:()=>a});var t=o(284);const r=async()=>{try{if(void 0===t.A)throw new Error("OpenCascade.js 라이브러리를 찾을 수 없습니다.");const e=await(0,t.A)();return console.log("OpenCascade.js 초기화 완료"),i("LOAD_SUCCESS"),e}catch(e){throw console.error("OpenCascade.js 초기화 오류:",e),i("LIB_ERROR",{message:e.message}),e}},a=e=>new Promise(((n,o)=>{let t=new FileReader;t.onload=()=>n(t.result),t.onerror=o,t.readAsText(e)})),s=e=>{switch(e.name.toLowerCase().split(".").pop()){case"step":case"stp":return"step";case"iges":case"igs":return"iges";default:return}};function i(e,n={}){const o=document.getElementById("result");switch(e){case"LOADING":o.innerHTML='<div class="loading">STEP 파일 분석 중...</div>';break;case"LOAD_SUCCESS":o.innerHTML='<p class="success">OpenCascade.js 로드 완료. STEP 파일을 선택해주세요.</p>';break;case"LIB_ERROR":o.innerHTML=`\n          <div class="error">\n            <h3>라이브러리 로드 오류</h3>\n            <p>${n.message}</p>\n            <p>브라우저 콘솔에서 추가 정보를 확인하세요.</p>\n          </div>\n        `;break;case"INIT_ERROR":o.innerHTML='\n          <div class="error">\n            <h3>라이브러리 오류</h3>\n            <p>OpenCascade.js를 초기화할 수 없습니다. 페이지를 새로고침 후 다시 시도해주세요.</p>\n          </div>\n        ';break;case"PROCESSING_ERROR":o.innerHTML=`\n          <div class="error">\n            <h3>오류 발생</h3>\n            <p>${n.message}</p>\n            <p>브라우저 콘솔에서 추가 정보를 확인하세요.</p>\n          </div>\n        `;break;case"RESULTS":o.innerHTML=`\n          <div class="success">STEP 파일을 성공적으로 처리했습니다!</div>\n          <h3>AABB 계산 결과</h3>\n          <p>치수: ${n.aabb.dimensions.x.toFixed(2)} × ${n.aabb.dimensions.y.toFixed(2)} × ${n.aabb.dimensions.z.toFixed(2)}</p>\n          <p>표면적: ${n.area.toFixed(2)} 제곱 단위</p>\n          <p>부피: ${n.volume.toFixed(2)} 입방 단위</p>\n          <h4>좌표</h4>\n          <p>최소: (${n.aabb.min.x.toFixed(2)}, ${n.aabb.min.y.toFixed(2)}, ${n.aabb.min.z.toFixed(2)})</p>\n          <p>최대: (${n.aabb.max.x.toFixed(2)}, ${n.aabb.max.y.toFixed(2)}, ${n.aabb.max.z.toFixed(2)})</p>\n        `}}},790:(e,n,o)=>{var t=o(387),r=o(514),a=o(525);const s={setOpenCascade(e){this.openCascade=e},tessellate(e){const n=[];new this.openCascade.BRepMesh_IncrementalMesh_2(e,.1,!1,.5,!1);const o=new this.openCascade.TopExp_Explorer_1;for(o.Init(e,this.openCascade.TopAbs_ShapeEnum.TopAbs_FACE,this.openCascade.TopAbs_ShapeEnum.TopAbs_SHAPE);o.More();o.Next()){const e=this.openCascade.TopoDS.Face_1(o.Current()),t=new this.openCascade.TopLoc_Location_1,r=this.openCascade.BRep_Tool.Triangulation(e,t,0);if(r.IsNull())continue;const a={vertex_coord:[],normal_coord:[],tri_indexes:[],number_of_triangles:0},s=new this.openCascade.Poly_Connect_2(r),i=r.get();a.vertex_coord=new Array(3*i.NbNodes());for(let e=1;e<=i.NbNodes();e++){const n=i.Node(e).Transformed(t.Transformation());a.vertex_coord[3*(e-1)+0]=n.X(),a.vertex_coord[3*(e-1)+1]=n.Y(),a.vertex_coord[3*(e-1)+2]=n.Z()}const c=new this.openCascade.TColgp_Array1OfDir_2(1,i.NbNodes());this.openCascade.StdPrs_ToolTriangulatedShape.Normal(e,s,c),a.normal_coord=new Array(3*c.Length());for(let e=c.Lower();e<=c.Upper();e++){const n=c.Value(e).Transformed(t.Transformation());a.normal_coord[3*(e-1)+0]=n.X(),a.normal_coord[3*(e-1)+1]=n.Y(),a.normal_coord[3*(e-1)+2]=n.Z()}const d=e.Orientation_1(),l=r.get().Triangles();a.tri_indexes=new Array(3*l.Length());let p=0;for(let e=1;e<=r.get().NbTriangles();e++){const n=l.Value(e);let o=n.Value(1),t=n.Value(2),r=n.Value(3);if(d!==this.openCascade.TopAbs_Orientation.TopAbs_FORWARD){let e=o;o=t,t=e}a.tri_indexes[3*p+0]=o,a.tri_indexes[3*p+1]=t,a.tri_indexes[3*p+2]=r,p++}a.number_of_triangles=p,n.push(a)}return n},joinPrimitives(e){let n=0,o=0,t=0,r=0;const a=[],s=[],i=[];return e.forEach((e=>{for(let o=0;o<e.vertex_coord.length/3;o++)a[3*n+0]=e.vertex_coord[3*o+0],a[3*n+1]=e.vertex_coord[3*o+1],a[3*n+2]=e.vertex_coord[3*o+2],n++;for(let n=0;n<e.normal_coord.length/3;n++)s[3*o+0]=e.normal_coord[3*n+0],s[3*o+1]=e.normal_coord[3*n+1],s[3*o+2]=e.normal_coord[3*n+2],o++;for(let n=0;n<e.tri_indexes.length/3;n++)i[3*t+0]=e.tri_indexes[3*n+0]+r-1,i[3*t+1]=e.tri_indexes[3*n+1]+r-1,i[3*t+2]=e.tri_indexes[3*n+2]+r-1,t++;r=n})),[a,s,i]},objGetTriangle(e,n){const o=3*n[3*e+0],t=3*n[3*e+1],r=3*n[3*e+2];return[[o,t,r],[o,t,r],[o,t,r]]},generateGeometry(e,n,o,t){const a=[],s=[];function i(e,n,o){a.push(new r.Pq0(e,n,o))}for(let o=0;o<e;o++){const[e,,]=this.objGetTriangle(o,t);i(n[e[0]+0],n[e[0]+1],n[e[0]+2]),i(n[e[1]+0],n[e[1]+1],n[e[1]+2]),i(n[e[2]+0],n[e[2]+1],n[e[2]+2])}for(let n=0;n<e;n++){const[,e]=this.objGetTriangle(n,t);c=0+3*n,d=1+3*n,l=2+3*n,p=o[e[0]+0],_=o[e[0]+1],h=o[e[0]+2],u=o[e[1]+0],m=o[e[1]+1],g=o[e[1]+2],w=o[e[2]+0],b=o[e[2]+1],f=o[e[2]+2],s.push(new r.nFj(c,d,l,[new r.Pq0(p,_,h),new r.Pq0(u,m,g),new r.Pq0(w,b,f)]))}var c,d,l,p,_,h,u,m,g,w,b,f;return[a,s]}},i=async(e,n,o)=>{s.setOpenCascade(e);const t=await s.tessellate(n),[a,i,c]=await s.joinPrimitives(t),d=t.reduce(((e,n)=>e+n.number_of_triangles),0),[l,p]=await s.generateGeometry(d,a,i,c),_=new r._4j({color:new r.Q1f(.9,.9,.9)}),h=new r.V23;h.vertices=l,h.faces=p;const u=new r.eaF(h,_);u.name="shape",u.rotation.x=-Math.PI/2,o.add(u)},c=(()=>{var e=new r.Z58,n=new r.ubm(75,window.innerWidth/window.innerHeight,.1,1e3),o=new r.JeP({antialias:!0});const t=document.getElementById("viewport"),s=t.getBoundingClientRect();o.setSize(s.width,s.height),t.appendChild(o.domElement);const i=new r.$p8(4210752);e.add(i);const c=new r.ZyN(16777215,.5);c.position.set(.5,.5,.5),e.add(c),n.position.set(0,50,100);const d=new a.N(n,o.domElement);return d.screenSpacePanning=!0,d.target.set(0,50,0),d.update(),function t(){requestAnimationFrame(t),o.render(e,n)}(),e})();(0,t.PA)().then((e=>{document.getElementById("step-file").addEventListener("input",(async n=>{await(async(e,n,o,r)=>{const a=(0,t.ti)(n),s=`file.${a}`;await(0,t.xc)(n).then((async t=>{e.FS.createDataFile("/",s,t,!0,!0);var i=null;if("step"===a?i=new e.STEPControl_Reader_1:"iges"===a?i=new e.IGESControl_Reader_1:console.error("opencascade.js can't parse this extension! (yet)"),i.ReadFile(s)===e.IFSelect_ReturnStatus.IFSelect_RetDone){console.log("file loaded successfully!     Converting to OCC now..."),i.TransferRoots(new e.Message_ProgressRange_1);const t=i.OneShape();console.log(n.name+" converted successfully!  Triangulating now..."),r.remove(r.getObjectByName("shape")),await o(e,t,r),console.log(n.name+" triangulated and added to the scene!"),e.FS.unlink(`/file.${a}`)}else console.error("Something in OCCT went wrong trying to read "+n.name)}))})(e,n.target.files[0],i,c)}))}))}},o={};function t(e){var r=o[e];if(void 0!==r)return r.exports;var a=o[e]={exports:{}};return n[e](a,a.exports,t),a.exports}t.m=n,e=[],t.O=(n,o,r,a)=>{if(!o){var s=1/0;for(l=0;l<e.length;l++){for(var[o,r,a]=e[l],i=!0,c=0;c<o.length;c++)(!1&a||s>=a)&&Object.keys(t.O).every((e=>t.O[e](o[c])))?o.splice(c--,1):(i=!1,a<s&&(s=a));if(i){e.splice(l--,1);var d=r();void 0!==d&&(n=d)}}return n}a=a||0;for(var l=e.length;l>0&&e[l-1][2]>a;l--)e[l]=e[l-1];e[l]=[o,r,a]},t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.p="/",(()=>{var e={631:0};t.O.j=n=>0===e[n];var n=(n,o)=>{var r,a,[s,i,c]=o,d=0;if(s.some((n=>0!==e[n]))){for(r in i)t.o(i,r)&&(t.m[r]=i[r]);if(c)var l=c(t)}for(n&&n(o);d<s.length;d++)a=s[d],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(l)},o=self.webpackChunkread_step_calc_aabb=self.webpackChunkread_step_calc_aabb||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))})();var r=t.O(void 0,[36,525],(()=>t(790)));r=t.O(r)})();
//# sourceMappingURL=render_threejs.4eb2efce05bb04e8e121.bundle.js.map